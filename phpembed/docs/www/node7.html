<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.70)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Initializing</TITLE>
<META NAME="description" CONTENT="Initializing">
<META NAME="keywords" CONTENT="phpembed">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="phpembed.css">

<LINK REL="next" HREF="node8.html">
<LINK REL="previous" HREF="node6.html">
<LINK REL="up" HREF="node6.html">
<LINK REL="next" HREF="node8.html">
</HEAD>

<BODY >
<!--Navigation Panel-->
<A NAME="tex2html311"
  HREF="node8.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="file:/usr/local/share/lib/latex2html/icons/next.png"></A> 
<A NAME="tex2html307"
  HREF="node6.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="file:/usr/local/share/lib/latex2html/icons/up.png"></A> 
<A NAME="tex2html301"
  HREF="node6.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="file:/usr/local/share/lib/latex2html/icons/prev.png"></A> 
<A NAME="tex2html309"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="file:/usr/local/share/lib/latex2html/icons/contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html312"
  HREF="node8.html">Calling functions</A>
<B> Up:</B> <A NAME="tex2html308"
  HREF="node6.html">Usage</A>
<B> Previous:</B> <A NAME="tex2html302"
  HREF="node6.html">Usage</A>
 &nbsp; <B>  <A NAME="tex2html310"
  HREF="node1.html">Contents</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->

<H2><A NAME="SECTION00061000000000000000">
Initializing</A>
</H2>

<P>
Initializing the object is as simple as including the code and instantiating it. 

<P>
<BLOCKQUOTE>
<code>#include "php_stl.h"</code>
<BR>...
<BR><code>php_stl p;</code>

</BLOCKQUOTE>

<P>
Passing <code>true</code> as an optional argument to the <code>php_stl</code> creator will enable warnings when the <code>php</code> object has to type cast a result returned from PHP evaluation. It is generally recommended to only turn those warnings on for debugging or if it is always an error condition for data of non-exact type to be returned by the PHP functions being called. The behavior of these type mismatch errors can also be controlled by changing error output behavior as described in the next paragraph. 

<P>
The <code>php</code> libraries have three different classes of output:

<P>

<UL>
<LI><I>Operational Output</I> - This class contains all the strings produced in PHP by such commands as <code>echo</code>, <code>print</code>, or <code>printf</code>. The default behavior of the <code>php</code> libraries is to print these strings to stdout prepended with the string ``PHP OUTPUT:''. <I>NOTE:</I> Due to its primary application as a hypertext processor the default behavior in PHP is to only flush the output buffer when the PHP interpreter is destroyed; to get the output flushed sooner use the PHP function <code>ob_flush()</code>.

<P>
</LI>
<LI><I>Messages</I> - This class contains all the strings which represent errors or warnings produced  in the interpretation of PHP but <I>not</I> fatal errors for the PHP interpreter itself or the <code>php</code> object. Good examples are calling an undefined function in PHP or using a non-array in the PHP <code>foreach</code> construct. The default behavior of the <code>php</code> libraries is to print these strings to stderr prepended with the string ``PHP MESSAGE:.''

<P>
</LI>
<LI><I>Errors</I> - This class contains all the error strings generated by the <code>php</code> object itself as it attempts to process the commands given. Such errors could result from improper argument passing, illegal function calling, or any generic malfunction in the core PHP interpreter code. The default behavior of the <code>php</code> libraries is to print this to stderr prepended with the string ``PHP ERROR:.'' <I>NOTE:</I> The aforementioned optional type mismatch errors fall into this class of output.
</LI>
</UL>

<P>
The client can alter the default behavior by providing an alternative function to handle the output:

<P>
<BLOCKQUOTE>
<code>void print_null(const char *str) {}</code>
<BR><code>void print_mine(const char *str) { printf("My Output: %s", str); }</code>
<BR>...
<BR><code>p.set_message_function(print_null);</code>
<BR><code>p.set_output_function(print_mine);</code>
<BR>
</BLOCKQUOTE>

<P>
This code directs the <code>php</code> object to discard all message output and prepend all operational output with the string ``My Output:'' before printing it to stdout. Default error output behavior remains in place although it could have been changed as well by passing <code>print_null</code> or <code>print_mine</code> to <code>set_error_function</code>. It is not a requirement to change any of output behaviors.

<P>
The final phase of initialization for most clients would be loading the PHP code into the interpreter:

<P><PRE>
if(SUCCESS != p.load("usage.php")){
  printf("load failed\n");
  exit(1);
}
</PRE>

<P>
This also isn't a requirement; clients could define functions just by creating strings in C++ and calling <code>eval_string</code> with them. In most cases the most flexible thing to do is keep that functionality in a separate file so it can be changed without having to recompile the binary. Note the check for success at the end, this is important so the program doesn't get too far before realizing the <code>php</code> object is broken. This check can be done after any function call to detect if the <code>php</code> object has gotten into a bad state.

<P>
<HR>
<!--Navigation Panel-->
<A NAME="tex2html311"
  HREF="node8.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="file:/usr/local/share/lib/latex2html/icons/next.png"></A> 
<A NAME="tex2html307"
  HREF="node6.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="file:/usr/local/share/lib/latex2html/icons/up.png"></A> 
<A NAME="tex2html301"
  HREF="node6.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="file:/usr/local/share/lib/latex2html/icons/prev.png"></A> 
<A NAME="tex2html309"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="file:/usr/local/share/lib/latex2html/icons/contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html312"
  HREF="node8.html">Calling functions</A>
<B> Up:</B> <A NAME="tex2html308"
  HREF="node6.html">Usage</A>
<B> Previous:</B> <A NAME="tex2html302"
  HREF="node6.html">Usage</A>
 &nbsp; <B>  <A NAME="tex2html310"
  HREF="node1.html">Contents</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
Andrew Bosworth
2008-03-24
</ADDRESS>
</BODY>
</HTML>
